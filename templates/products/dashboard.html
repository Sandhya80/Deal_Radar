{% extends 'base.html' %}
{% load static %}

{% block title %}My Dashboard - Deal Radar{% endblock %}

{% block extra_css %}
    <link rel="stylesheet" href="{% static 'css/dashboard.css' %}">
{% endblock %}

{% block content %}
<div class="dashboard">
    <div class="dashboard-header">
        <h1>🎯 Your Personal Dashboard</h1>
        <p>Track your favorite products and manage price alerts</p>
    </div>

    <div class="stats-grid">
        <div class="stat-card">
            <div class="stat-number">{{ total_tracked }}</div>
            <h3>Products Tracked</h3>
            <p>Items in your watchlist</p>
        </div>
        <div class="stat-card">
            <div class="stat-number">{{ total_alerts }}</div>
            <h3>Active Alerts</h3>
            <p>Price notifications enabled</p>
        </div>
        <div class="stat-card">
            <div class="stat-number">{{ tracked_products|length }}</div>
            <h3>Active Items</h3>
            <p>Currently being tracked</p>
        </div>
    </div>

    <div class="section-header">
        <h2>🛍️ Your Tracked Products</h2>
        <a href="{% url 'home' %}" class="btn btn-primary">+ Add More Products</a>
    </div>

    {% if tracked_products %}
        {% for tracked in tracked_products %}
            <div class="tracked-product-item">
                <h3>{{ tracked.product.name }}</h3>
                <div class="tracked-product-price">£{{ tracked.product.current_price }}</div>
                
                <div class="tracked-product-meta">
                    {% if tracked.target_price %}
                        <p><strong>🎯 Target Price:</strong> £{{ tracked.target_price }}</p>
                    {% endif %}
                    <p><strong>🏪 Site:</strong> {{ tracked.product.site_name|default:"Not specified" }}</p>
                    <p><strong>📂 Category:</strong> {{ tracked.product.category|default:"Uncategorized" }}</p>
                    <p><strong>📅 Added:</strong> {{ tracked.added_at|date:"M d, Y" }}</p>
                    {% if tracked.notes %}
                        <p><strong>📝 Notes:</strong> {{ tracked.notes|truncatechars:100 }}</p>
                    {% endif %}
                </div>
                
                <div class="tracked-product-actions">
                    <a href="{% url 'product_detail' tracked.product.pk %}" class="btn btn-primary">View Details</a>
                    <a href="{{ tracked.product.url }}" target="_blank" class="btn btn-secondary">Visit Site</a>
                    <a href="{% url 'remove_from_tracking' tracked.product.pk %}" class="btn btn-danger">Remove</a>
                </div>
            </div>
        {% endfor %}
    {% else %}
        <div class="empty-state">
            <h3>🎯 No Products Tracked Yet</h3>
            <p>Start building your watchlist by adding products you want to track!</p>
            <a href="{% url 'home' %}" class="btn btn-primary">Browse Products</a>
        </div>
    {% endif %}

    <div class="quick-actions">
        <h3>🔧 Quick Actions</h3>
        <a href="{% url 'home' %}" class="btn btn-primary">🔍 Find More Products</a>
        <a href="/admin/" class="btn btn-secondary">🎛️ Admin Panel</a>
    </div>
</div>
{% endblock %}

{% block extra_js %}
    <script src="{% static 'js/dashboard.js' %}"></script>
{% endblock %}